data:
  data_dir: /nfs5/zxd/Huawei/datasets/lora/
  stats_path: ./data/stats.pth
  num_workers: 8
  train_ratio: 0.9
  device: cuda:0
  token_size: 128
  cond_shape:
  - 224
  - 512
  original_shapes:
    a1:
    - 2
    - 64
    b1:
    - 2048
    - 2
    a2:
    - 2
    - 2048
    b2:
    - 64
    - 2
  max_len: 66
resampler:
  latent_cond_len: 128
  hidden_dim: 1024
  num_heads: 8
  depth: 4
  dropout: 0.2
diffusion:
  timesteps: 1000
  prediction_type: eps
  snr_gamma: 5.0
  betas:
    scheduler_type: linear
    beta_start: 0.0001
    beta_end: 0.02
    s: 0.008
  small_weight: 0.3
dit:
  num_heads: 8
  depth: 12
  mlp_ratio: 4.0
  dropout: 0.2
train:
  seed: 3407
  epochs: 10000
  batch_size: 200
  weight_decay: 0.05
  grad_accum_steps: 8
  save_interval: 100
  val_interval: 10
  grad_clip: 1.0
  cfg_drop_rate: 0.1
  ema_rate: 0.999
  cond_noise_factor: 0.01
lr_scheduler:
  type: cosine_warmup
  max_lr: 0.0004
  warmup_ratio: 0.1
  start_lr: 1.0e-05
  eta_min: 1.0e-05
inference:
  seed: 3407
  use_ema: true
  config: exps/eps14/logs/config.yaml
  checkpoint_path: exps/eps14/ckpts/best.pth
  cond_path: /home/zxd/zxd/Huawei/datasets/lora/test/conditions/seed5/05184.pth
  cfg_scale: 1.0
  use_ddim: true
  ddim_steps: 50
  eta: 1.0
  output_dir: exps/eps14/inference
mode: train
exp_dir: exps/eps16
msg: 1
